<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EVEXApp - Admin</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/admin.css">
</head>
<body>
<div class="app-layout">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="logo-brand">BCA Expertise</div>
      <div class="logo-app">EVEX</div>
    </div>
    <div class="sidebar-event">
      <div class="ev-label">Ã‰vÃ©nement actif</div>
      <div class="ev-code">5G1</div>
      <div class="ev-name">GrÃªle Anglet : Juin 2025</div>
    </div>
    <nav class="sidebar-nav">
      <div class="nav-section">Navigation</div>
      <div class="nav-item" data-nav="dashboard" onclick="window.location.href='dashboard.html'">
        Parc de vÃ©hicules
      </div>
      <div class="nav-item active" data-nav="admin">
        Administration
      </div>
      <div class="nav-section">Gestion</div>
      <div class="nav-item">
        <span class="nav-icon">ðŸ“‚</span>
        EVEX
      </div>
      <div class="nav-item">
        <span class="nav-icon">ðŸ‘¥</span>
        Utilisateurs
      </div>
      <div class="nav-item">
        <span class="nav-icon">ðŸ“¤</span>
        Exports
      </div>
    </nav>
    <div class="sidebar-user">
      <div class="user-avatar">?</div>
      <div class="user-info">
        <div class="user-name">â€”</div>
        <div class="user-role">â€”</div>
      </div>
      <button class="user-logout" title="DÃ©connexion">â‡¥</button>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main-content">
    <div class="topbar">
      <div class="topbar-title">Administration â€” Ã‰vÃ©nement 5G1</div>
      <button class="btn btn-secondary btn-sm" onclick="window.location.href='dashboard.html'">
        ðŸš— Voir le parc
      </button>
      <button class="btn btn-primary" onclick="exportRapport()">
        ðŸ“¤ Exporter le rapport
      </button>
    </div>

    <div class="page-content">

      <!-- Stat Cards -->
      <div class="stat-grid">
        <div class="stat-card s-none">
          <div class="stat-label">Total vÃ©hicules</div>
          <div class="stat-value" data-stat="total">â€”</div>
          <div class="stat-sub">dans le parc</div>
        </div>
        <div class="stat-card s-active">
          <div class="stat-label">En cours</div>
          <div class="stat-value" data-stat="active">â€”</div>
          <div class="stat-sub">expertises actives</div>
        </div>
        <div class="stat-card s-grele">
          <div class="stat-label">TraitÃ©s (total)</div>
          <div class="stat-value" data-stat="done">â€”</div>
          <div class="stat-sub">clÃ´turÃ©s</div>
        </div>
        <div class="stat-card s-non">
          <div class="stat-label">Non vus</div>
          <div class="stat-value" data-stat="none">â€”</div>
          <div class="stat-sub">en attente</div>
        </div>
      </div>

      <!-- Progress Overview -->
      <div class="progress-overview">
        <div class="po-header">
          <span class="po-title">Progression de l'Ã©vÃ©nement : GrÃªle Anglet Juin 2025</span>
          <span class="po-pct">0%</span>
        </div>
        <div class="po-bar-wrap">
          <div class="po-bar-fill" style="width:0%"></div>
        </div>
        <div class="po-stats">
          <div class="po-stat">
            <div class="po-dot" style="background:var(--status-none)"></div>
            <span data-stat="none">â€”</span> pas encore vus
          </div>
          <div class="po-stat">
            <div class="po-dot" style="background:var(--status-active)"></div>
            <span data-stat="active">â€”</span> en cours
          </div>
          <div class="po-stat">
            <div class="po-dot" style="background:var(--status-grele)"></div>
            <span data-stat="grele">â€”</span> grÃªlÃ©s
          </div>
          <div class="po-stat">
            <div class="po-dot" style="background:var(--status-non)"></div>
            <span data-stat="non">â€”</span> non grÃªlÃ©s
          </div>
        </div>
      </div>

      <!-- Admin Grid -->
      <div class="admin-grid">

        <!-- Left: Expert activity + Code builder -->
        <div>
          <!-- Expert Activity Table -->
          <div class="card mb-24">
            <div class="card-header">
              <span style="font-size:18px">ðŸ‘¥</span>
              <div class="card-title">ActivitÃ© des experts</div>
              <span style="margin-left:auto;font-size:11px;color:var(--text-muted)">ðŸ”„ Temps rÃ©el (30s)</span>
            </div>
            <div class="card-body" style="padding:0">
              <table class="expert-table">
                <thead>
                  <tr>
                    <th>Expert</th>
                    <th>Statut</th>
                    <th>VÃ©hicule en cours</th>
                    <th>TraitÃ©s</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="expert-tbody"></tbody>
              </table>
            </div>
          </div>

          <!-- Import Zone -->
          <div class="card">
            <div class="card-header">
              <span style="font-size:18px">ðŸ“‚</span>
              <div class="card-title">Import du fichier Parc</div>
            </div>
            <div class="card-body">
              <div class="import-zone">
                <div class="import-icon">ðŸ“„</div>
                <div class="import-text">Glisser-dÃ©poser votre fichier ou cliquer</div>
                <div class="import-sub">Formats acceptÃ©s : CSV, Excel (.xlsx, .xls)</div>
              </div>
              <p style="margin-top:12px;font-size:11px;color:var(--text-muted);text-align:center">
                Les donnÃ©es actuelles correspondent au fichier <strong>SLAVI_ANGLET.xlsx</strong> (15 vÃ©hicules)
              </p>
            </div>
          </div>
        </div>

        <!-- Right: Code builder + Activity log -->
        <div>
          <!-- Code EVEX Builder -->
          <div class="code-builder mb-24">
            <div class="code-builder-title">GÃ©nÃ©rateur de code EVEX</div>

            <div class="code-display"><span>5</span>G<span>1</span></div>
            <div class="code-description">GrÃªle 2025 â€” 1Ã¨re occurrence</div>

            <div class="code-inputs">
              <div>
                <label style="font-size:10px;color:rgba(255,255,255,.4);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;display:block">AnnÃ©e</label>
                <select id="code-year">
                  <option value="5" selected>2025</option>
                  <option value="4">2024</option>
                  <option value="6">2026</option>
                </select>
              </div>
              <div>
                <label style="font-size:10px;color:rgba(255,255,255,.4);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;display:block">Type</label>
                <select id="code-type">
                  <option value="G" selected>G : GrÃªle</option>
                  <option value="I">I : Inondation</option>
                  <option value="T">T : TempÃªte</option>
                  <option value="V">V : Vandalisme</option>
                  <option value="F">F : Incendie</option>
                </select>
              </div>
              <div>
                <label style="font-size:10px;color:rgba(255,255,255,.4);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;display:block">Occurrence</label>
                <input type="number" id="code-occ" value="1" min="1" max="9">
              </div>
              <div>
                <label style="font-size:10px;color:rgba(255,255,255,.4);letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;display:block">Nb vÃ©hicules</label>
                <input type="number" id="code-count" value="15" min="1">
              </div>
            </div>

            <div class="catnat-warning" style="display:none">
              âš  Moins de 10 vÃ©hicules â€” Code CATNAT permanent appliquÃ©
            </div>

            <button class="btn btn-primary" style="width:100%;margin-top:16px" onclick="TOAST.show('âœ… Code EVEX crÃ©Ã© et enregistrÃ©', 'success')">
              CrÃ©er l'Ã©vÃ©nement
            </button>
          </div>

          <!-- Activity Log -->
          <div class="card">
            <div class="card-header">
              <span style="font-size:18px">ðŸ“‹</span>
              <div class="card-title">Journal d'activitÃ©</div>
            </div>
            <div class="card-body">
              <div class="activity-log"></div>
            </div>
          </div>
        </div>

      </div><!-- /admin-grid -->

      <!-- Export Section -->
      <div class="card mt-24">
        <div class="card-header">
          <span style="font-size:18px">ðŸ“¤</span>
          <div class="card-title">Export & Transmission du rapport</div>
        </div>
        <div class="card-body">
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px">
            <div style="background:var(--bg);border-radius:var(--radius-sm);padding:16px;border:1px solid var(--border)">
              <div style="font-size:11px;font-weight:700;color:var(--bca-blue);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Onglet REP</div>
              <p style="font-size:12px;color:var(--text-mid);margin-bottom:12px">DonnÃ©es complÃ¨tes d'expertise par vÃ©hicule, avec formules de calcul.</p>
              <button class="btn btn-secondary btn-sm" onclick="TOAST.show('ðŸ“Š Onglet REP gÃ©nÃ©rÃ©', 'success')">
                ðŸ“Š GÃ©nÃ©rer REP
              </button>
            </div>
            <div style="background:var(--navy);border-radius:var(--radius-sm);padding:16px">
              <div style="font-size:11px;font-weight:700;color:var(--blue-light);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Rapport complet</div>
              <p style="font-size:12px;color:rgba(255,255,255,.5);margin-bottom:12px">Fichier Excel complet REP prÃªt Ã  transmettre Ã  l'Ã©metteur.</p>
              <button class="btn btn-primary btn-sm" onclick="exportRapport()">
                ðŸ“¤ Exporter & Transmettre
              </button>
            </div>
          </div>
        </div>
      </div>

    </div><!-- /page-content -->
  </main>
</div>

<div class="toast-container"></div>
<script src="js/data.js"></script>
<script src="js/auth.js"></script>
<script src="js/admin.js"></script>
</body>
</html>
